---
title: "Lab2_Esther"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(ggplot2)
library(dplyr)
library(GGally)
```

```{r read}
#read in dataset
drive <- read.csv("./data/bad-drivers.csv") 
head(drive)
#rename the cols 
drive <- drive %>% rename(amt_per_bil_miles = Number.of.drivers.involved.in.fatal.collisions.per.billion.miles, 
                          pct_speeding = Percentage.Of.Drivers.Involved.In.Fatal.Collisions.Who.Were.Speeding, 
                          pct_alcohol_impaired = Percentage.Of.Drivers.Involved.In.Fatal.Collisions.Who.Were.Alcohol.Impaired, 
                          pct_not_distracted = Percentage.Of.Drivers.Involved.In.Fatal.Collisions.Who.Were.Not.Distracted, 
                          pct_no_previous = Percentage.Of.Drivers.Involved.In.Fatal.Collisions.Who.Had.Not.Been.Involved.In.Any.Previous.Accidents, 
                          premiums = Car.Insurance.Premiums...., 
                          losses = Losses.incurred.by.insurance.companies.for.collisions.per.insured.driver....)
colnames(drive)
```

```{r eda}
#draftsmans plot
pairs(drive, gap = 0)
#histogram
ggplot(drive, aes(x = pct_speeding)) +
  geom_histogram(bins = 15)
```
Premiums and losses have a positive relationship. 
```{r regression}
#Simple
reg01 <- lm(premiums ~ pct_no_previous, drive)
summary(reg01)
#Multiple
reg02 <- lm(premiums ~ pct_no_previous + amt_per_bil_miles + pct_speeding, drive)
summary(reg02)
#Polynomial
reg03 <- lm(premiums ~ poly(pct_no_previous, 2, raw=TRUE), drive)
summary(reg03)
#plot
ggplot(drive, aes(x = pct_no_previous, y = premiums)) +
  geom_point() +
  stat_smooth(method='lm', formula = y~poly(x,2))
```


```{r holdout}

```

